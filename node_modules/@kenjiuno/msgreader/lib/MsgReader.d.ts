export interface ParserConfig {
    /**
     * Observe property writing (this is not complete solution!)
     */
    propertyObserver?: (fields: FieldsData, tag: number, raw: Uint8Array | null) => void;
    /**
     * Include {@link FieldsData.rawProps} while decoding msg.
     */
    includeRawProps?: boolean;
}
/**
 * Some OXPROPS
 *
 * Note that please sync with: `CONST.MSG.FIELD.NAME_MAPPING`
 *
 * @see [[MS-OXPROPS]: Exchange Server Protocols Master Property List | Microsoft Docs](https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxprops/f6ab1613-aefe-447d-a49c-18217230b148)
 */
export interface SomeOxProps {
    /**
     * Contains the subject of the email message.
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/0037-PidTagSubject.md
     */
    subject?: string;
    /**
     * Contains the display name of the sending mailbox owner.
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/0C1A-PidTagSenderName.md
     */
    senderName?: string;
    /**
     * Contains the email address of the sending mailbox owner.
     *
     * e.g.
     *
     * - `xmailuser@xmailserver.test` for {@link senderAddressType} = 'SMTP'
     * - `/O=EXCHANGELABS/OU=EXCHANGE ADMINISTRATIVE GROUP (xxx)/CN=RECIPIENTS/CN=xxx` for {@link senderAddressType} = 'EX'
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/0C1F-PidTagSenderEmailAddress.md
     */
    senderEmail?: string;
    /**
     * Contains message body text in plain text format.
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/1000-PidTagBody.md
     */
    body?: string;
    /**
     * Contains transport-specific message envelope information for email.
     *
     * e.g.
     *
     * ```
     * Return-Path: <xmailuser@xmailserver.test>
     * Delivered-To: xmailuser@xmailserver.test
     * X-AuthUser: xmailuser@xmailserver.test
     * Received: from H270 ([127.0.0.1]:56695)
     *     by xmailserver.test with [XMail 1.27 ESMTP Server]
     *     id <S9> for <xmailuser@xmailserver.test> from <xmailuser@xmailserver.test>;
     *     Tue, 12 May 2020 14:45:17 +0900
     * From: Microsoft Outlook <xmailuser@xmailserver.test>
     * To: =?utf-8?B?eG1haWx1c2Vy?= <xmailuser@xmailserver.test>
     * Subject: =?utf-8?B?TWljcm9zb2Z0IE91dGxvb2sg44OG44K544OIIOODoeODg+OCu+ODvOOCuA==?=
     * MIME-Version: 1.0
     * Content-Type: text/html;
     *     charset=\"utf-8\"
     * Content-Transfer-Encoding: 8bit
     *
     * ```
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/007D-PidTagTransportMessageHeaders.md
     */
    headers?: string;
    /**
     * Contains message body text in compressed RTF format.
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/1009-PidTagRtfCompressed.md
     */
    compressedRtf?: Uint8Array;
    /**
     * Contains a file name extension that indicates the document type of an attachment.
     *
     * e.g. `.png`
     *
     * Target {@link dataType} = 'attachment'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/3703-PidTagAttachExtension.md
     */
    extension?: string;
    /**
     * Contains an attachment's base file name and extension, excluding path.
     *
     * e.g. `green.png`
     *
     * Target {@link dataType} = 'attachment'.
     *
     * @see https://docs.microsoft.com/en-US/office/client-developer/outlook/mapi/pidtagattachfilename-canonical-property
     */
    fileNameShort?: string;
    /**
     * Contains an attachment's long filename and extension, excluding path.
     *
     * e.g. `green.png`
     *
     * Target {@link dataType} = 'attachment'.
     *
     * @see https://docs.microsoft.com/en-US/office/client-developer/outlook/mapi/pidtagattachlongfilename-canonical-property
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/3707-PidTagAttachLongFilename.md
     */
    fileName?: string;
    /**
     * Contains a content identifier unique to the Message object that matches a
     * corresponding "cid" URI schema reference in the HTML body of the Message object.
     *
     * Target {@link dataType} = 'attachment'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/3712-PidTagAttachContentId.md
     */
    pidContentId?: string;
    /**
     * Contains the display name of the folder.
     *
     * e.g.
     *
     * - `xmailuser` for recipient.
     * - `green.png` for generic attachment.
     * - `I have attachments!` for msg attachment.
     *
     * Target {@link dataType} = 'recipient' and 'attachment'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/3001-PidTagDisplayName.md
     */
    name?: string;
    /**
     * Contains the email address of a Message object.
     *
     * e.g.
     *
     * - `xmailuser@xmailserver.test` for {@link addressType} = 'SMTP'
     * - `/o=ExchangeLabs/ou=Exchange Administrative Group (xxx)/cn=Recipients/cn=xxx` for {@link addressType} = 'EX'
     *
     * Target {@link dataType} = 'recipient'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/3003-PidTagEmailAddress.md
     */
    email?: string;
    /**
     * Contains the time, in UTC, that the object was created.
     *
     * e.g. `Mon, 15 Feb 2021 08:19:21 GMT`
     *
     * Target {@link dataType} = 'msg' and 'attachment'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/3007-PidTagCreationTime.md
     */
    creationTime?: string;
    /**
     * Contains the time, in UTC, of the last modification to the object.
     *
     * e.g. `Mon, 15 Feb 2021 08:19:21 GMT`
     *
     * Target {@link dataType} = 'msg' and 'attachment'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/3008-PidTagLastModificationTime.md
     */
    lastModificationTime?: string;
    /**
     * Contains the current time, in UTC, when the email message is submitted.
     *
     * e.g. `Mon, 15 Feb 2021 08:19:04 GMT`
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/0039-PidTagClientSubmitTime.md
     */
    clientSubmitTime?: string;
    /**
     * Specifies the time (in UTC) when the server received the message.
     *
     * e.g. `Mon, 15 Feb 2021 08:19:00 GMT`
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/0E06-PidTagMessageDeliveryTime.md
     */
    messageDeliveryTime?: string;
    /**
     * This undocumented `creatorSMTPAddress` will be attached
     * when you send a mail via Exchange Online server.
     *
     * e.g.
     *
     * - `xxx@xxx.onmicrosoft.com` for {@link senderAddressType} = 'EX'
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://social.microsoft.com/Forums/partner/en-US/8e15ac6d-0404-41c0-9af7-26a06ca797bf/meaning-of-mapi-identifiers-0x5d0a-and-0x5d0b?forum=os_exchangeprotocols
     * @see https://github.com/HiraokaHyperTools/msgreader/issues/10
     */
    creatorSMTPAddress?: string;
    /**
     * This undocumented `lastModifierSMTPAddress` will be attached
     * when you send a mail via Exchange Online server.
     *
     * e.g.
     *
     * - `xxx@xxx.onmicrosoft.com` for {@link senderAddressType} = 'EX'
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://social.microsoft.com/Forums/partner/en-US/8e15ac6d-0404-41c0-9af7-26a06ca797bf/meaning-of-mapi-identifiers-0x5d0a-and-0x5d0b?forum=os_exchangeprotocols
     * @see https://github.com/HiraokaHyperTools/msgreader/issues/10
     */
    lastModifierSMTPAddress?: string;
    /**
     * Contains the SMTP address of the Message object.
     *
     * e.g.
     *
     * - `xxx@xxx.onmicrosoft.com` for {@link addressType} = 'EX'
     *
     * Target {@link dataType} = 'recipient'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/39FE-PidTagSmtpAddress.md
     * @see https://github.com/HiraokaHyperTools/msgreader/issues/10
     */
    smtpAddress?: string;
    /**
     * Contains the name of the last mail user to change the Message object.
     *
     * A email address may be stored in `lastModifierName`, if it was sent through Exchange Server.
     *
     * `lastModifierSMTPAddress` or `smtpAddress` may not be stored in some cases.
     *
     * e.g.
     *
     * - `UnoKenji` for {@link senderAddressType} = 'EX'
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/3FFA-PidTagLastModifierName.md
     * @see https://github.com/HiraokaHyperTools/msgreader/issues/10
     */
    lastModifierName?: string;
    /**
     * Contains the email address type of a Message object.
     *
     * e.g.
     *
     * - `EX`
     * - `SMTP`
     *
     * Target {@link dataType} = 'recipient'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/3002-PidTagAddressType.md
     * @see https://github.com/HiraokaHyperTools/msgreader/issues/10
     */
    addressType?: string;
    /**
     * Contains the email address type of the sending mailbox owner.
     *
     * e.g.
     *
     * - `EX`
     * - `SMTP`
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/0C1E-PidTagSenderAddressType.md
     * @see https://github.com/HiraokaHyperTools/msgreader/issues/10
     */
    senderAddressType?: string;
    /**
     * Indicates whether an attachment is hidden from the end user.
     *
     * Target {@link dataType} = 'attachment'.
     *
     * @see https://docs.microsoft.com/en-us/office/client-developer/outlook/mapi/pidtagattachmenthidden-canonical-property
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/7FFE-PidTagAttachmentHidden.md
     */
    attachmentHidden?: boolean;
    /**
     * VerbResponse (PidLidVerbResponse)
     *
     * e.g.
     *
     * - `Yes`
     * - `はい`
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxprops/88f982ff-0146-422b-8545-0701b5e7916e
     * @see https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxomsg/eb67f145-2ceb-4427-bbc1-f67a6dcbd24b
     */
    votingResponse?: string;
    /**
     * Contains message body text in HTML format.
     *
     * @see https://docs.microsoft.com/ja-jp/office/client-developer/outlook/mapi/pidtagbodyhtml-canonical-property
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/1013-PidTagBodyHtml.md
     */
    bodyHtml?: string;
    /**
     * Contains message body text in HTML format.
     *
     * @see https://docs.microsoft.com/en-us/office/client-developer/outlook/mapi/pidtaghtml-canonical-property
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/1013-PidTagHtml.md
     */
    html?: Uint8Array;
    /**
     * PidLidInternetAccountName
     *
     * Specifies the user-visible email account name through which the email message is sent.
     *
     * The format of this string is implementation dependent.
     * This property can be used by the client to determine which server to direct the mail to,
     * but is optional and the value has no meaning to the server.
     *
     * e.g. `xmailuser@xmailserver.test`
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://docs.microsoft.com/en-us/office/client-developer/outlook/mapi/pidlidinternetaccountname-canonical-property
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/00008580-PidLidInternetAccountName.md
     */
    inetAcctName?: string;
}
export interface SomeParsedOxProps {
    /**
     * Contains the recipient type for a message recipient.
     *
     * Target {@link dataType} = 'recipient'.
     *
     * @see https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxomsg/144ae256-8cf2-45a1-a297-221b44f68cfe
     * @see https://docs.microsoft.com/en-us/office/client-developer/outlook/mapi/pidtagrecipienttype-canonical-property
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/0C15-PidTagRecipientType.md
     */
    recipType?: "to" | "cc" | "bcc";
    /**
     * VerbStream (PidLidVerbStream)
     *
     * e.g.
     *
     * - `Yes;No;Maybe`
     * - `はい;いいえ;たぶん`
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxprops/e11cc753-cecf-4fdc-bec7-23304d12388a
     * @see https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxomsg/89a70cdb-28ca-4d63-9deb-6d8c15c2cb47
     */
    votingOptions?: string;
    /**
     * Contains the format of the Simple Mail Transport Protocol (SMTP) email address of the sending mailbox owner.
     *
     * e.g.
     * `no-reply@microsoft.com` for {@link senderAddressType} = 'SMTP'
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://docs.microsoft.com/en-us/office/client-developer/outlook/mapi/pidtagsendersmtpaddress-canonical-property
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/5D01-PidTagSenderSmtpAddress.md
     */
    senderSmtpAddress?: string;
    /**
     * Contains the Simple Mail Transport Protocol (SMTP) email address for the messaging user who is represented by the sender.
     *
     * e.g.
     * `no-reply@microsoft.com` for {@link senderAddressType} = 'SMTP'
     *
     * Target {@link dataType} = 'msg'.
     *
     * @see https://docs.microsoft.com/en-us/office/client-developer/outlook/mapi/pidtagsentrepresentingsmtpaddress-canonical-property
     * @see https://github.com/HiraokaHyperTools/OXPROPS/blob/master/JSON/5D02-PidTagSentRepresentingSmtpAddress.md
     */
    sentRepresentingSmtpAddress?: string;
}
export interface FieldsData extends SomeOxProps, SomeParsedOxProps {
    dataType: null | "msg" | "attachment" | "recipient";
    /**
     * The attachment file's contentLength.
     *
     * Target {@link dataType} = 'attachment'.
     */
    contentLength?: number;
    /**
     * The attachment file's dataId (for internal use).
     *
     * This is entry index to CFBF stream.
     *
     * Target {@link dataType} = 'attachment'.
     */
    dataId?: number;
    /**
     * folderId is internal and valid for embedded msg file.
     *
     * This is entry index to CFBF storage.
     *
     * Target {@link dataType} = 'attachment'.
     */
    folderId?: number;
    /**
     * innerMsgContent is set to true, if this attachment is embedded msg.
     *
     * The embedded msg is represented as a CFBF storage (not single CFBF stream).
     *
     * Target {@link dataType} = 'attachment'.
     */
    innerMsgContent?: true;
    /**
     * The properties defined in embedded msg.
     *
     * Target {@link dataType} = 'attachment'.
     */
    innerMsgContentFields?: FieldsData;
    /**
     * The collection of attachment files:
     *
     * ```json
     * {
     *   "dataType": "attachment",
     *   "name": "A.txt",
     *   "fileNameShort": "A.txt",
     *   "dataId": 40,
     *   "contentLength": 11,
     *   "extension": ".txt",
     *   "fileName": "A.txt"
     * }
     * ```
     *
     * Use with {@link MsgReader.getAttachment}.
     *
     * Target {@link dataType} = 'msg'.
     */
    attachments?: FieldsData[];
    /**
     * The collection of recipients:
     *
     * ```json
     * {
     *   "dataType": "recipient",
     *   "name": "to@example.com",
     *   "email": "to@example.com",
     *   "recipType": "to"
     * },
     * ```
     *
     * Target {@link dataType} = 'msg'.
     */
    recipients?: FieldsData[];
    /**
     * error is set on parse error.
     *
     * Target {@link dataType} = 'msg'.
     */
    error?: string;
    /**
     * All properties obtained while decoding msg.
     *
     * To activate this:
     *
     * - Prepare new {@link MsgReader.parserConfig}.
     * - Set {@link ParserConfig.includeRawProps} to `true`.
     * - And then invoke {@link MsgReader.getFileData}.
     */
    rawProps?: RawProp[];
}
/**
 * RawProp includes value for every property.
 */
export interface RawProp {
    /**
     * PidTag, as lower case hex str (8 chars).
     *
     * Every proerty should have single PidTag.
     *
     * DWORD (8 hex chars) format is:
     *
     * - HIWORD (first 4 chars) is identifier. e.g. `3001` is PidTagDisplayName.
     * - LOWORD (last 4 chars) is data type. e.g. `001f` is PT_UNICODE.
     *
     * e.g.
     *
     * - `3001001f` is set for PidTagDisplayName.
     * - `80000000` ~ `ffffffff` are private tags. Need to inspect: {@link propertySet} and {@link propertyLid}
     *
     * @see [[MS-OXPROPS]: Property ID Ranges | Microsoft Docs](https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxprops/ed38d6e3-2871-4cb5-ab3e-0aebe9d02c21)
     * @see [[MS-OXCDATA]: Property Data Types | Microsoft Docs](https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/MS-OXCDATA/0c77892e-288e-435a-9c49-be1c20c7afdb)
     */
    propertyTag: string | undefined;
    /**
     * Property set, as lower case GUID str (36 chars)
     *
     * The private {@link propertyTag} (`80000000` ~ `ffffffff`) should have both this and {@link propertyLid}
     *
     * e.g. `00062008-0000-0000-c000-000000000046` is set for PSETID_Common.
     *
     * @see [[MS-OXPROPS]: Commonly Used Property Sets | Microsoft Docs](https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxprops/cc9d955b-1492-47de-9dce-5bdea80a3323)
     */
    propertySet: string | undefined;
    /**
     * Long ID (LID), as lower case hex str (8 chars)
     *
     * The private {@link propertyTag} (`80000000` ~ `ffffffff`) should have both this and {@link propertySet}
     *
     * e.g. `00008580` is set for PidLidInternetAccountName.
     *
     * @see [[MS-OXPROPS]: Structures | Microsoft Docs](https://docs.microsoft.com/en-us/openspecs/exchange_server_protocols/ms-oxprops/37dd7329-97a4-42ff-974d-d805ac4d7211)
     */
    propertyLid: string | undefined;
    /**
     * The value depends on property.
     */
    value?: string | Uint8Array;
}
/**
 * The core implementation of MsgReader
 */
export default class MsgReader {
    private reader;
    private fieldsData;
    parserConfig?: ParserConfig;
    private innerMsgBurners;
    /**
     * pidTag: 0x8000 ~ 0xFFFF
     */
    private privatePidToKeyed;
    constructor(arrayBuffer: ArrayBuffer | DataView);
    private decodeField;
    private fieldsDataDocument;
    private setDecodedFieldTo;
    private getFieldType;
    private fieldsDataDirInner;
    private burnMsg;
    private registerFolder;
    private fieldsRecipAndAttachmentProperties;
    private fieldsRootProperties;
    private fieldsDataDir;
    private fieldsNameIdDir;
    /**
     * extract real fields
     */
    private fieldsDataReader;
    /**
     * convert binary data to dictionary
     */
    private parseMsgData;
    getFileData(): FieldsData;
    /**
     Reads an attachment content by key/ID
    
      @return {Object} The attachment for specific attachment key
      */
    getAttachment(attach: number | FieldsData): {
        fileName: string;
        content: Uint8Array;
    };
}
